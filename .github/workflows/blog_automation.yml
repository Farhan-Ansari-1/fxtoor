# d:\fxtoor\.github\workflows\blog_automation.yml

name: "Generate New Blog Post"

on:
  # Yeh option aapko GitHub ke “Actions” tab se workflow ko manually chalane deta hai.
  workflow_dispatch:

  # Ise schedule per chalaane ke liye.
  # Yeh har Monday subah 7:00 AM UTC (India ke time ke hisaab se 12:30 PM) per chalega.
  schedule:
    - cron: "0 7 * * 1"

# GITHUB_TOKEN ki permissions set kar raha hai
permissions:
  contents: write   # Repo me commit aur push karne ki permission deta hai

jobs:
  generate-post:
    runs-on: ubuntu-latest   # Workflow ek Ubuntu virtual machine per chalega

    steps:
      # Step 1: Repo ka code virtual machine me checkout karta hai
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          # Python script ko git push karne ke liye token zaroori hai
          token: ${{ secrets.GITHUB_TOKEN }}

      # Step 2: Python environment set karta hai
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      # Step 3: requirements.txt me listed sabhi Python packages install karta hai
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install --upgrade google-generativeai python-dotenv

      # Step 4: Blog generate karne wali Python script chalata hai
      - name: Run Blog Agent
        run: python scripts/blog_agent.py
        env:
          # Gemini API key ko GitHub Secrets se secure tarike se load karta hai
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
